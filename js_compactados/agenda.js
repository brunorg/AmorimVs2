function reset(a){1==a?($("#linha1 #L10L .tipoAg").removeClass("clicado"),$("#linha1 #L10L .tipoAg").css("background-position","0px 0px")):2==a&&($("#linha2 #L10A .tipoAg").removeClass("clicado"),$("#linha2 #L10A .tipoAg").css("background-position","0px 0px"))}function criarTipoEvento(a){var b,c="tipoEvento="+a;if(""!=$(".infoValueP #evento").val()){var b=setCreateData("TipoEvento",c);"erro"!=b?mensagem("Cadastrado com sucesso!","OK","bt_ok","sucesso"):mensagem("Erro ao cadastrar!","OK","bt_ok","erro")}else mensagem("Preencha o campo tipo evento!","OK","bt_ok","erro");return b}function criarEvento(a,b,c,d,e,f,g,h){var i=new Date,j=i.getFullYear(),k="dataInicio="+c+"&dataFim="+d+"&evento="+e+"&descricao="+b+"&tipoEvento="+a+"&ano="+j+"&aula="+g+"&feriado="+f+"&hora="+h+"&visivel=1",l=setCreateData("Calendario",k);return"erro"!=l?mensagem("Cadastrado com sucesso!","OK","bt_ok","sucesso"):mensagem("Erro ao cadastrar!","OK","bt_ok","erro"),l}function montarEdicao(a){$(".boxAgenda").css({height:"240px","margin-bottom":"15px"}),$("#frmCadastroEvento").css("display","block"),$(".btnForm").css("display","none");var b=getData("Calendario",a),c=$("#tipo_evento");c.val(null!=b.tipoEvento?c.find('option[value="'+b.tipoEvento.idtipoEvento+'"]').val():c.find('option[value="-1"]').val()),1==b.feriado?$("#L10L .inputImg ").eq(0).addClass("clicado"):$("#L10L .inputImg ").eq(1).addClass("clicado"),1==b.aula?$("#L10L .inputImg ").eq(0).addClass("clicado"):$("#L10L .inputImg ").eq(1).addClass("clicado"),$("#idEvento").val(a),$("#titulo").val(b.evento),$("#descricao").val(b.descricao),$("#dataInicio").val(b.dataInicio),$("#dataFinal").val(b.dataFim),$("#hora").val(b.hora),reset(1),reset(2),1==b.feriado?$('.feriado:contains("Sim")').filter(":first").next().addClass("clicado").css("background-position","-38px 0px"):0==b.feriado&&$('.feriado:contains("N\xe3o")').filter(":first").next().addClass("clicado").css("background-position","-38px 0px"),1==b.aula?$('.agenda:contains("Sim")').filter(":first").next().addClass("clicado").css("background-position","-38px 0px"):0==b.aula&&$('.agenda:contains("N\xe3o")').filter(":first").next().addClass("clicado").css("background-position","-38px 0px"),$("#btnSalvarEvento").css("display","none"),$("#btnEditarEvento").css("display","block")}function editarEvt(){var b=validaForm();if("undefined"==typeof b){var c=$("#tipo_evento").val(),d=$("#titulo").val(),e=$("#descricao").val(),f=$("#dataInicio").val(),g=$("#dataFinal").val(),h=$("#hora").val(),i=$("#L10L .clicado").next().attr("value");if(1==i)j=0;else var j=$("#L10A .clicado").next().attr("value");if(""!=f&&""!=g){var k=parseInt(f.split("-")[2].toString()+f.split("-")[1].toString()+f.split("-")[0].toString()),l=parseInt(g.split("-")[2].toString()+g.split("-")[1].toString()+g.split("-")[0].toString());k>l?mensagem("Data t\xe9rmino n\xe3o pode ser maior que a data in\xedcio!","OK","bt_ok","erro"):editar(c,e,f,g,d,i,j,h)}else editar(c,e,f,g,d,i,j,h)}}function editar(a,b,c,d,e,f,g,h){var k,i=new Date,j=i.getFullYear(),l=$("#idEvento").val(),m="action=update&dataInicio="+c+"&dataFim="+d+"&evento="+e+"&descricao="+b+"&tipoEvento="+a+"&ano="+j+"&aula="+g+"&feriado="+f+"&hora="+h+"&visivel=1",k=setUpdateData("Calendario",m,l);if("erro"!=k){var a=$("#tipo_evento");a.val(a.find('option[value="-1"]').val()),$("#idEvento").val(""),$("#titulo").val(""),$("#descricao").val(""),$("#dataInicio").val(""),$("#dataFinal").val(""),$("#btnSalvarEvento").css("display","block"),$("#btnEditarEvento").css("display","none"),$(".inputImg").css("background-position","0px 0px"),$("input[type='radio']").removeAttr("checked"),$(".clicado").removeClass("clicado");var n=c;n=n.split("-");var o=n[2]+"/"+n[1]+"/"+n[0];$("#eve_"+l+" .titulo_evento").html("<span class='dataEvn'>"+o+"</span> <span class='dataHora'>"+h+"</span> "+e),mensagem("Evento editado com sucesso!","OK","bt_ok","sucesso");var p=$(".clicadoFoto");1==p.length?($("#idCalendarioEvento").val(l),$(".blackPainel").css("display","block"),GerarUpload($("#foto"),$("#fotoEvento"),$("#fotoEvento")),$("#fotoEvento").change(function(){$("#LegendaUpload").html("Arquivo Carregado")})):mensagem("Alterado com sucesso!","OK","bt_ok","sucesso")}else mensagem("Erro ao alterar evento, verifique os campos!","OK","bt_ok","erro")}function excluirEvt(a,b){mensagem("Deseja realmente excluir?","Cancelar","bt_cancelar","confirm",a,b,"excluirEvtConfirm")}function excluirEvtConfirm(a,b){deleteData(a,b),$("#boxMensagemGeral").hide(),$("#eve_"+b).remove()}function salvarFotoEvento(){var a=$("#idCalendarioEvento").val(),b=$("#fotoEvento").val(),c=b.substring(b.lastIndexOf(".")).toLowerCase(),d=c.split(".");if("jpg"==d[1]||"png"==d[1]||"jpeg"==d[1]){var e=new FormData($("#inserirArquivo")[0]);upload("Calendario/upload/calendario/",a,e)}else mensagem("Este arquivo n\xe3o \xe9 uma imagem!, verifique os campos!","OK","bt_ok","erro")}function validaForm(){if(-1==$("#tipo_evento").val())return mensagem("Por favor, preencha o campo tipo do evento!","OK","bt_ok","erro"),$("#tipo_evento").focus(),!1;if(""==$("#dataInicio").val())return mensagem("Por favor, preencha o campo data in\xedcio!","OK","bt_ok","erro"),$("#dataInicio").focus(),!1;var a=new Date,b=$("#dataInicio").val();return b.toString().substring(0,4)<a.getFullYear()||b.toString().substring(0,4)==a.getFullYear()&&b.toString().substring(5,7)<a.getMonth()+1||b.toString().substring(0,4)==a.getFullYear()&&b.toString().substring(5,7)==a.getMonth()+1&&b.toString().substring(8,10)<a.getDate()?(mensagem("Data de in\xedcio n\xe3o pode ser anterior a data atual!","OK","bt_ok","erro"),!1):""==$("#titulo").val()?(mensagem("Por favor, preencha o t\xedtulo!","OK","bt_ok","erro"),$("#titulo").focus(),!1):"undefined"==typeof $("#L10L .clicado").next().attr("value")?(mensagem("Por favor, preencha o campo feriado!","OK","bt_ok","erro"),!1):"undefined"==typeof $("#L10A .clicado").next().attr("value")?(mensagem("Por favor, preencha o campo aula!","OK","bt_ok","erro"),!1):void 0}var alunoID=2,UsuarioAtivo=2,Limite,HtmlContent,contador,ultimo_id,dataTipoEvento=getData("TipoEvento",null),dataAnoLetivo=getData("AnoLetivo",null),dataCalendario=getData("Calendario/visivel",null);$(document).ready(function(){$("#hora").timepicker({hourText:"Horas",minuteText:"Minutos",showPeriodLabels:!1}),HtmlContentT="";for(var a=0;a<dataTipoEvento.length;a++)HtmlContentT+="<option value='"+dataTipoEvento[a].idtipoEvento+"'>"+dataTipoEvento[a].tipoEvento+"</option>";if($("#tipo_evento").html("<option value='-1'></option>"+HtmlContentT),$(".close_upload_producao").click(function(){$(".blackPainel").css("display","none")}),$("#btnSalvarEvento").click(function(){var a,b=$("#L10L .clicado").next().attr("value");if(1==b)c=0;else var c=$("#L10A .clicado").next().attr("value");var d=validaForm();if("undefined"==typeof d){var e=$("#tipo_evento").val(),f=$("#titulo").val(),g=$("#descricao").val(),h=$("#dataInicio").val(),i=$("#dataFinal").val(),j=$("#hora").val(),b=$("#L10L .clicado").next().attr("value");if(1==b)c=0;else var c=$("#L10A .clicado").next().attr("value");if(""!=h&&""!=i){var l=parseInt(h.split("-")[2].toString()+h.split("-")[1].toString()+h.split("-")[0].toString()),m=parseInt(i.split("-")[2].toString()+i.split("-")[1].toString()+i.split("-")[0].toString());l>m?mensagem("Data t\xe9rmino n\xe3o pode ser menor que a data in\xedcio!","OK","bt_ok","erro"):a=criarEvento(e,g,h,i,f,b,c,j)}else a=criarEvento(e,g,h,i,f,b,c,j);if(""!=a&&"erro"!=a){$("#tipo_evento").val(""),$("#titulo").val(""),$("#descricao").val(""),$("#dataInicio").val(""),$("#dataFinal").val(""),$("#hora").val(""),$(".inputImg").css("background-position","0px 0px"),$("input[type='radio']").removeAttr("checked"),$(".clicado").removeClass("clicado");var n="",o=getData("Calendario",a);if(void 0!=o.idcalendario){var p=o.dataInicio;p=p.split("-");var q=p[2]+"/"+p[1]+"/"+p[0];n+="<div class='item' id=eve_"+o.idcalendario+"><div class='titulo_evento'><span class='dataEvn'>"+q+"</span> <span class='dataHora'>"+o.hora+"</span> "+o.evento+"</div> <span class='editar' onclick='montarEdicao("+o.idcalendario+")'></span><span class='excluir' onclick='excluirEvt(\"Calendario\", "+o.idcalendario+")'></span></div>"}else n="";var r=$("#agenda_listados .item");r.length>0?$(n).insertBefore("#agenda_listados .item:first"):$("#agenda_listados").html(n);var s=$(".clicadoFoto");1==s.length&&($("#idCalendarioEvento").val(o.idcalendario),$(".blackPainel").css("display","block"),GerarUpload($("#foto"),$("#fotoEvento"),$("#fotoEvento")),$("#fotoEvento").change(function(){$("#LegendaUpload").html("Arquivo Carregado")}))}}}),$("#abrirCaixa").click(function(){$(".boxAgenda").css({height:"240px","margin-bottom":"15px"}),$("#frmCadastroEvento").css("display","block"),$(".btnForm").css("display","none")}),$("#btnCancelar").click(function(){$(".btnForm").css("display","block"),$("#frmCadastroEvento").css("display","none"),$(".boxAgenda").css({height:"558px","margin-bottom":"0px"})}),HtmlContentEv="","undefined"!=typeof dataCalendario){for(var b=0;b<dataCalendario.length;b++)if(null!=dataCalendario[b].dataFim?dataUsar=dataCalendario[b].dataFim:null!=dataCalendario[b].dataInicio&&(dataUsar=dataCalendario[b].dataInicio),null!=dataUsar){var c=new Date,d=c.getFullYear(),e=dataUsar;e=e.split("-");var f=e[2]+"/"+e[1]+"/"+e[0];e[0]==d&&(HtmlContentEv+="<div class='item' id=eve_"+dataCalendario[b].idcalendario+"><div class='titulo_evento'><span class='dataEvn'>"+f+"</span> <span class='dataHora'>"+dataCalendario[b].hora+"</span> "+dataCalendario[b].evento+"</div><span class='editar' onclick='montarEdicao("+dataCalendario[b].idcalendario+")'></span><span class='excluir' onclick='excluirEvt(\"Calendario\","+dataCalendario[b].idcalendario+")'></span></div>")}$("#agenda_listados").html(HtmlContentEv)}$(".tipoAg").click(function(){var a=this;0==$(a).hasClass("clicado")?$(a).css("background-position","-38px 0px").addClass("clicado"):$(a).css("background-position","0px 0px").removeClass("clicado"),$(this).parent().find("input[type=radio]").removeAttr("checked",!1),$(this).next("input[type=radio]").attr("checked",!0)}),$(".tipoFt").click(function(){var a=this;0==$(a).hasClass("clicadoFoto")?$(a).css("background-position","-38px 0px").addClass("clicadoFoto"):$(a).css("background-position","0px 0px").removeClass("clicadoFoto")})});