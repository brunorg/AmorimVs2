function IndicarPresenca(a){var b=$(".Aluno_Grupo"+a);if(""==$("#Grupo_Id_"+a+" .dataPresenca").val())var c=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();else c=$("#Grupo_Id_"+a+" .dataPresenca").val().split("/")[2]+"-"+$("#Grupo_Id_"+a+" .dataPresenca").val().split("/")[1]+"-"+$("#Grupo_Id_"+a+" .dataPresenca").val().split("/")[0];console.log(c);for(var e=0;e<b.length;e++)""!=$("#"+b[e].id+" [class^='status_presenca']")[0].id?0!=$("#"+b[e].id+" .status_presenca_falta").length?(action="update",valores="&data="+c+"&presenca=0&aluno="+b[e].id.split("_")[1]+"&id="+$("#"+b[e].id+" .status_presenca_falta")[0].id.split("_")[1]):(action="update",valores="&data="+c+"&presenca=1&aluno="+b[e].id.split("_")[1]+"&id="+$("#"+b[e].id+" .status_presenca_presenca")[0].id.split("_")[1]):0!=$("#"+b[e].id+" .status_presenca_falta").length?(action="create",valores="&data="+c+"&presenca=0&aluno="+b[e].id.split("_")[1]):(action="create",valores="&data="+c+"&presenca=1&aluno="+b[e].id.split("_")[1]),$.ajax({type:"POST",async:!1,crossDomain:!0,url:path+"Chamada",data:"action="+action+valores,beforeSend:function(){loading("inicial")},success:function(a){$("#"+b[e].id+" [class^='status_presenca']")[0].id="chamada_"+a,mensagem("Presen\xe7a apontada com sucesso!","OK","bt_ok","sucesso"),"create"==action&&($("#"+b[e].id+" [class^='status_presenca']").removeClass("status_presenca_naoIndicado"),$("#"+b[e].id+" [class^='status_presenca']").addClass("status_presenca_indicado"))},error:function(){mensagem("Erro ao apontar presen\xe7a!","OK","bt_ok","erro")},complete:function(){loading("final")}})}function ApareceAlunos(a){$(".Aluno_Grupo"+a).toggle(),$(".indicar_"+a).toggle()}var userID=usuarioId,d=new Date,dataUsuario,dataTutoria,dataGrupos;$.ajax({url:path+"Usuario/"+userID,type:"GET",async:!1,crossDomain:!0,success:function(a){dataUsuario=a}}),$.ajax({url:path+"Tutoria/Professor/"+dataUsuario.professor.idprofessorFuncionario+"/"+d.getFullYear(),type:"GET",async:!1,crossDomain:!0,success:function(a){dataTutoria=a}}),$.ajax({url:path+"Grupo/GrupoTutoria/"+dataTutoria[0].idtutoria,type:"GET",async:!1,crossDomain:!0,success:function(a){dataGrupos=a}}),$(document).ready(function(){for(var a=0;a<dataGrupos.length;a++){var b;if($.ajax({url:path+"AlunoVariavel/grupo/"+dataGrupos[a].idgrupo,type:"GET",async:!1,crossDomain:!0,success:function(a){b=a}}),b.length>0){HtmlContent="",HtmlContent+="<div class='grupo'>",HtmlContent+="<div id='Grupo_Id_"+dataGrupos[a].idgrupo+"' class='grupo_nome'>",HtmlContent+="<div class='grupo_nome_tabela_texto' onclick='ApareceAlunos("+dataGrupos[a].idgrupo+")'>",HtmlContent+=dataGrupos[a].nomeGrupo,HtmlContent+="</div>",HtmlContent+="<input type='text' class='dataPresenca' hidden>",HtmlContent+="</div>",HtmlContent+="</div>",$(".total").append(HtmlContent),HtmlContent="";for(var c=0;c<b.length;c++){var e,f;$.ajax({url:path+"Chamada/faltas/"+b[c].aluno.idAluno,type:"GET",async:!1,crossDomain:!0,success:function(a){e=a}}),$.ajax({url:path+"Chamada/dataChamada/"+b[c].aluno.idAluno+"/"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate(),type:"GET",async:!1,crossDomain:!0,success:function(a){0==a.length?f='<div class="status_presenca_falta">':0==a[0].presenca?f='<div id="chamada_'+a[0].idchamada+'" class="status_presenca_falta">':1==a[0].presenca&&(f='<div id="chamada_'+a[0].idchamada+'" class="status_presenca_presenca">')}}),HtmlContent+='<div class="AlunoLeft Aluno_Grupo'+dataGrupos[a].idgrupo+'" id="Aluno_'+b[c].aluno.idAluno+'"><div class="titulo_infos_aluno"><div class="faltas_aluno"><div class="presenca_botao"><div class="indicar_presenca_aluno">'+f+'</div></div></div></div><div class="nome_aluno">'+b[c].aluno.nome+"</div></div></div></div>"}HtmlContent+='<div class="AlunoLeft Aluno_Grupo'+dataGrupos[a].idgrupo+' ultimo"><div class="titulo_infos_aluno"><div class="faltas_aluno"></div><div class=\'grupo_indicar indicar_'+dataGrupos[a].idgrupo+"' onclick='IndicarPresenca("+dataGrupos[a].idgrupo+")'>Confirma</div></div></div>",HtmlContent+='<div style="clear: both;"></div>',$(".total").append(HtmlContent)}}$("[class^='status_presenca_']").click(function(){$(this).hasClass("status_presenca_presenca")?($(this).removeClass("status_presenca_presenca"),$(this).addClass("status_presenca_falta")):($(this).addClass("status_presenca_presenca"),$(this).removeClass("status_presenca_falta"))}),$(".dataPresenca").datepicker({showOn:"button",beforeShow:function(){$("#box_novo").css("height","285px")},buttonImage:"img/calendario.png",buttonImageOnly:!0,buttonText:"Select date",dateFormat:"dd/mm/yy",showOtherMonths:!0,dayNamesMin:["D","S","T","Q","Q","S","S","D"],monthNames:["JANEIRO","FEVEREIRO","MAR\xc7O","ABRIL","MAIO","JUNHO","JULHO","AGOSTO","SETEMBRO","OUTUBRO","NOVEMBRO","DEZEMBRO"]})});